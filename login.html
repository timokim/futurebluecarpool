<!DOCTYPE html>

<html>

<head>

  <meta charset="utf-8">

  <title>Login - FutureBlue Carpool</title>

  <link rel="stylesheet" href="css/w3_1.css" type="text/css">
  <link rel="stylesheet" href="css/w3_2.css" type="text/css">  
  <link rel="stylesheet" href="css/carpool.css" type="text/css">
  <style>

  </style>

</head>

<body style="background-image: url('img/road.jpg'); background-size:100%; background-position: top">
  <div class="navbar">
      <table>
        <tr><td width="80%" style="padding-left:20px">FutureBlue Carpool</td></tr>
      </table>
  </div>
  <div class="welcome-pane">
    <div class="login-box">
      <br /><br /><h1>Your adventure is steps away.</h1><br />
      <form class="ibm-column-form ibm-styled-form" name="login" action="javascript:login_page()" method="get" autocomplete="on">  
        <label for="usermail">Email</label>  
        <input name="email" id="email" placeholder="you@ca.ibm.com" type="text" required>
        <div style="height:10px"></div>
        <label id="password" for="password">Password</label>  
        <input type="password" name="password" placeholder="password" required>
        <br /><br /><a href="register.html" style="text-decoration:none; color:white">Register</a><span>   </span>
        <input class="ibm-btn-pri" type="submit" value="Login" type="button"/>
      </form>
      <div id="login-error-msg">Incorrect email or password. Try again.</div>
    </div>
  </div>
  <script src="js/jquery-1.10.2.min.js"></script>
  <script src="js/app.js"></script>

  <script>
  $("#login-error-msg").hide();
  if(isloggedin()){
    if(readCookie("userinfo").usertype === "owner")
      window.location.href = "ownerHome.html";
    else
      window.location.href = "riderHome.html";
  }
  var hasBack = QueryString.back; // Support for back to previous page before log in
  function login_page(){
    var email = $("#email").val();
    var password = ""; // Not implemented for now
    login(email, function(data){
      if(data === -1){
        $("#login-error-msg").show();
      }else{
        //var hasBack = QueryString.back; // Useless as we only have few pages.
        console.log("a")
        if(hasBack)
          window.location.href = hasBack;
        else if(data.usertype === "owner")
          window.location.href = "ownerHome.html";
        else
          window.location.href = "riderHome.html";
      }
    });
  }
  </script>

</body>

</html>